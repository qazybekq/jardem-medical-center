#!/bin/bash

# üöÄ –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–ø–ª–æ—è –≤ Streamlit Cloud
# –ê–≤—Ç–æ—Ä: AI Assistant
# –î–∞—Ç–∞: 2025-10-20

echo "üöÄ –î–ï–ü–õ–û–ô –°–ò–°–¢–ï–ú–´ –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ú–ï–î–ò–¶–ò–ù–°–ö–ò–ú –¶–ï–ù–¢–†–û–ú"
echo "================================================"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
if [ ! -f "app.py" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: app.py –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Git –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
if [ ! -d ".git" ]; then
    echo "üì¶ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è..."
    git init
    echo "‚úÖ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω"
fi

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
echo "üîê –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π..."
python generate_secure_passwords.py

# –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã –≤ Git
echo "üìÅ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ Git..."
git add .

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
echo "üìä –°—Ç–∞—Ç—É—Å Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:"
git status

# –°–æ–∑–¥–∞–µ–º –∫–æ–º–º–∏—Ç
echo "üíæ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞..."
git commit -m "Deploy: Medical Center Management System v3.2.0

- –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º —Ü–µ–Ω—Ç—Ä–æ–º
- CRM —Å–∏—Å—Ç–µ–º–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º –∏ –ø—Ä–∏–µ–º–∞–º–∏
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–∫–ª–∏–µ–Ω—Ç—ã, —É—Å–ª—É–≥–∏, –≤—Ä–∞—á–∏)
- –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å —Ä–æ–ª—è–º–∏
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é –≤ Streamlit Cloud"

echo "‚úÖ –ö–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
if ! git remote get-url origin > /dev/null 2>&1; then
    echo ""
    echo "üåê –ù–ê–°–¢–†–û–ô–ö–ê GITHUB –†–ï–ü–û–ó–ò–¢–û–†–ò–Ø"
    echo "================================"
    echo "1. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub.com"
    echo "2. –°–∫–æ–ø–∏—Ä—É–π URL —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
    echo "3. –í–≤–µ–¥–∏ –µ–≥–æ –Ω–∏–∂–µ:"
    echo ""
    read -p "URL GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: " repo_url
    
    if [ -n "$repo_url" ]; then
        git remote add origin "$repo_url"
        echo "‚úÖ –£–¥–∞–ª–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω"
    else
        echo "‚ùå URL –Ω–µ –≤–≤–µ–¥–µ–Ω. –î–æ–±–∞–≤—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤—Ä—É—á–Ω—É—é:"
        echo "   git remote add origin https://github.com/USERNAME/REPO_NAME.git"
        exit 1
    fi
fi

# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –≤–µ—Ç–∫—É –≤ main
echo "üåø –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–µ—Ç–∫–∏ –≤ main..."
git branch -M main

# –ó–∞–≥—Ä—É–∂–∞–µ–º –≤ GitHub
echo "‚¨ÜÔ∏è  –ó–∞–≥—Ä—É–∑–∫–∞ –≤ GitHub..."
git push -u origin main

if [ $? -eq 0 ]; then
    echo ""
    echo "üéâ –£–°–ü–ï–®–ù–û –ó–ê–ì–†–£–ñ–ï–ù–û –í GITHUB!"
    echo "==============================="
    echo ""
    echo "üìã –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:"
    echo "=================="
    echo ""
    echo "1. üåê –ó–∞–π–¥–∏ –Ω–∞ https://share.streamlit.io"
    echo "2. üîë –í–æ–π–¥–∏ —á–µ—Ä–µ–∑ GitHub –∞–∫–∫–∞—É–Ω—Ç"
    echo "3. ‚ûï –ù–∞–∂–º–∏ 'New app'"
    echo "4. ‚öôÔ∏è  –ù–∞—Å—Ç—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:"
    echo "   - Repository: —Ç–≤–æ–π_username/–Ω–∞–∑–≤–∞–Ω–∏–µ_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è"
    echo "   - Branch: main"
    echo "   - Main file path: app.py"
    echo "5. üîê –î–æ–±–∞–≤—å —Å–µ–∫—Ä–µ—Ç—ã (–ø–∞—Ä–æ–ª–∏ –∏–∑ generated_passwords.txt)"
    echo "6. üöÄ –ù–∞–∂–º–∏ 'Deploy!'"
    echo ""
    echo "üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: DEPLOYMENT_GUIDE.md"
    echo ""
    echo "üéØ –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —Ç–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:"
    echo "   https://–Ω–∞–∑–≤–∞–Ω–∏–µ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è-—Ç–≤–æ–π-username.streamlit.app"
    echo ""
    echo "‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é!"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ GitHub"
    echo "–ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Git –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞"
    exit 1
fi
